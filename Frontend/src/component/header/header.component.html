<!-- Main Header Container -->
<header class="bg-gradient-to-r from-purple-800 to-gray-900 shadow-lg py-4 px-6 md:px-10 flex items-center justify-between z-40 relative">
    <!-- Application Logo/Name -->
    <div class="flex items-center space-x-3">
        <!-- Optional: Add a simple SVG icon for the app logo -->
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
        </svg>
        <a class="text-white text-3xl font-extrabold tracking-wide cursor-pointer" (click)="redirectToHome()">NoteApp</a>
    </div>

    <!-- User/Login Section -->
    <div class="flex items-center space-x-6">
        <!-- 使用 AsyncPipe 訂閱 isLoggedIn$ Observable 來判斷顯示內容 -->
        <ng-container *ngIf="(isLoggedIn$ | async) as loggedIn">
            <ng-container *ngIf="loggedIn; else loggedOut">
                <!-- 登入狀態：顯示用戶名首字母、用戶名和登出按鈕 -->
                <div class="flex items-center space-x-3">
                    <!-- 用戶首字母圖標 -->
                    <div class="user-initial-icon flex items-center justify-center
                                  w-10 h-10 rounded-full bg-blue-500 text-white font-bold text-xl
                                  border-2 border-blue-400">
                        {{ getUserInitial() }}
                    </div>
                    <!-- 用戶名 -->
                    <span class="text-white font-medium text-lg">
                        歡迎, {{ username$ | async }}!
                    </span>
                    <!-- 登出按鈕 -->
                    <button (click)="onLogoutClick()"
                            class="text-blue-300 hover:text-blue-100 transition-colors duration-200
                                   font-medium text-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75 rounded-md px-3 py-2">
                        登出
                    </button>
                </div>
            </ng-container>

            <ng-template #loggedOut>
                <!-- 未登入狀態：顯示登入按鈕 -->
                <button (click)="onLoginClick()"
                        class="flex items-center space-x-2 text-blue-300 hover:text-blue-100 transition-colors duration-200
                               font-medium text-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75 rounded-md px-3 py-2">
                    <!-- 用戶圖標 -->
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                    <span>登入</span>
                </button>
            </ng-template>
        </ng-container>
    </div>
</header>
